<%- include('../partials/header.ejs') %>

 <link rel="stylesheet" href="/css/admin.css">
    <div class="container">
        <form method="post" onsubmit=" return validarFormulario()"
            action="https://simplificada.saude.paulista.pe.gov.br/send" enctype="multipart/form-data">
          <div class="animated-bg"></div>

  <!-- Formulário -->
            <div class="form-group">
                <label for="name">Nome Completo do Cadidato:</label>
                <input type="text" id="name" name="name" placeholder="Digite seu nome completo..." required required
                    pattern="[A-Za-zÀ-ÿ\s]+" title="Apenas letras e espaços são permitidos" />
            </div>

            <div class="form-group">
                <label for="cpf">CPF (Sem Ponto ou Hífen):</label>
                <input type="text" id="cpf" name="cpf" placeholder="Digite seu CPF..." required
                    oninput="validarCPF(this)" />
                <span id="cpfErro" style="color: red; display: none;">CPF inválido!</span>
            </div>

            <div class="form-group">
                <label for="birth">Data de Nascimento:</label>
                <input type="date" id="birth" name="birth" required />
            </div>


          <!----  <div class="form-group">
                <label for="ageinyears">Idade do candidato no dia da inscrição:</label>
                <input type="text" id="ageinyears" name="ageinyears" placeholder="Digite sua idade..." required
                    oninput="this.value = this.value.replace(/[^\d]/g, '').slice(0,2)" />
            </div>
        -->
            <div class="form-group">
                <label for="gender">Sexo:</label>
                <select id="gender" name="gender" required>
                    <option value="" disabled selected>Selecione seu sexo</option>
                    <option value="MASCULINO">MASCULINO</option>
                    <option value="FEMININO">FEMININO</option>
                    <!-- <option value="NÃO_BINÁRIO">NÃO-BINÁRIO</option>
          <option value="TRANSMASCULINO">TRANSMASCULINO</option>
          <option value="TRANSFEMININO">TRANSFEMININO</option> -->
                    <!-- <option value="OUTRO">OUTRO</option> -->
                </select>
            </div>

            <div class="form-group">
                <label for="rg">RG ou Documento Oficial de Identificação (Sem Ponto):</label>
                <input type="text" id="rg" name="rg" placeholder="Digite seu RG..." required
                    oninput="this.value = this.value.replace(/[^\d]/g, '').slice(0,11)" />
            </div>

            <div class="form-group">
                <label for="organ">Órgão Emissor:</label>
                <input type="text" id="organ" name="organ" placeholder="Digite o orgão emissor..." required
                    oninput="this.value = this.value.replace(/[^A-Za-z0-9\/]/g, '').slice(0, 21)" />
            </div>

            <div class="form-group">
                <label for="uf">UF:</label>
                <select id="uf" name="uf" required>
                    <option value="" disabled selected>Selecione seu estado</option>
                    <option value="AC">AC</option>
                    <option value="AL">AL</option>
                    <option value="AP">AP</option>
                    <option value="AM">AM</option>
                    <option value="BA">BA</option>
                    <option value="CE">CE</option>
                    <option value="DF">DF</option>
                    <option value="ES">ES</option>
                    <option value="GO">GO</option>
                    <option value="MA">MA</option>
                    <option value="MT">MT</option>
                    <option value="MS">MS</option>
                    <option value="MG">MG</option>
                    <option value="PA">PA</option>
                    <option value="PB">PB</option>
                    <option value="PR">PR</option>
                    <option value="PE">PE</option>
                    <option value="PI">PI</option>
                    <option value="RJ">RJ</option>
                    <option value="RN">RN</option>
                    <option value="RS">RS</option>
                    <option value="RO">RO</option>
                    <option value="RR">RR</option>
                    <option value="SC">SC</option>
                    <option value="SP">SP</option>
                    <option value="SE">SE</option>
                    <option value="TO">TO</option>
                </select>
            </div>

           <!---- <div class="form-group">
                <label for="title">Título de Eleitor:</label>
                <input type="text" id="title" name="title" placeholder="Digite o título de eleitor..." required
                    oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 12)" />
            </div>

            <div class="form-group">
                <label for="pis">Número do PIS:</label>
                <input type="text" id="pis" name="pis" placeholder="Digite o número do PIS..." required
                    oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 12)" />
            </div>
        -->
            <div class="form-group">
                <label for="civilstatus">Estado Civil:</label>
                <select id="civilstatus" name="civilstatus" required>
                    <option value="" disabled selected>Selecione seu estado civil</option>
                    <option value="SOLTEIRO">SOLTEIRO</option>
                    <option value="CASADO">CASADO</option>
                    <option value="DIVORCIADO">DIVORCIADO</option>
                    <option value="VIÚVO">VIÚVO</option>
                    <option value="SEPARADO">SEPARADO</option>
                    <option value="UNIÃO ESTÁVEL">UNIÃO ESTÁVEL</option>
                </select>
            </div>

            <div class="form-group">
                <label for="education">ESCOLARIDADE:</label>
                <select id="education" name="education" required>
                    <option value="" disabled selected>Selecione sua escolaridade</option>
                    <option value="FUNDAMENTAL">FUNDAMENTAL</option>
                    <option value="MÉDIO">MÉDIO</option>
                    <option value="SUPERIOR INCOMPLETO">SUPERIOR INCOMPLETO</option>
                    <option value="SUPERIOR COMPLETO">SUPERIOR COMPLETO</option>
                    <option value="ESPECIALIZAÇÃO">ESPECIALIZAÇÃO</option>
                    <option value="MESTRADO">MESTRADO</option>
                    <option value="DOUTORADO">DOUTORADO</option>
                </select>
            </div>



            <div class="form-group">
                <label for="mother">Nome completo da mãe:</label>
                <input type="text" id="mother" name="mother" placeholder="Digite o nome da sua mãe..." required
                    pattern="[A-Za-zÀ-ÿ\s]+" title="Apenas letras e espaços são permitidos" />
            </div>


            <div class="form-group">
                <label for="nationality">Nacionalidade:</label>
                <input type="text" id="nationality" name="nationality" placeholder="Digite sua nacionalidade..."
                    required pattern="[A-Za-zÀ-ÿ\s]+" title="Apenas letras e espaços são permitidos"
                    oninput="this.value = this.value.replace(/[^A-Za-zÀ-ÿ\s]/g, '')" />
            </div>

            <div class="form-group">
                <label for="cityofbirth">Naturalidade cidade:</label>
                <input type="text" id="cityofbirth" name="cityofbirth" placeholder="Digite sua naturalidade..." required
                    pattern="[A-Za-zÀ-ÿ\s]+" title="Apenas letras e espaços são permitidos"
                    oninput="this.value = this.value.replace(/[^A-Za-zÀ-ÿ\s]/g, '')" />
            </div>
            <div class="form-group">
                <label for="birthplacestate">Naturalidade Estado:</label>
                <select id="birthplacestate" name="birthplacestate" required>
                    <option value="" disabled selected>Selecione seu estado</option>
                    <option value="AC">ACRE</option>
                    <option value="AL">ALAGOAS</option>
                    <option value="AP">AMAPÁ</option>
                    <option value="AM">AMAZONAS</option>
                    <option value="BA">BAHIA</option>
                    <option value="CE">CEARÁ</option>
                    <option value="DF">DISTRITO FEDERAL</option>
                    <option value="ES">ESPÍRITO SANTO</option>
                    <option value="GO">GOIÁS</option>
                    <option value="MA">MARANHÃO</option>
                    <option value="MT">MATO GROSSO</option>
                    <option value="MS">MATO GROSSO DO SUL</option>
                    <option value="MG">MINAS GERAIS</option>
                    <option value="PA">PARÁ</option>
                    <option value="PB">PARAÍBA</option>
                    <option value="PR">PARANÁ</option>
                    <option value="PE">PERNAMBUCO</option>
                    <option value="PI">PIAUÍ</option>
                    <option value="RJ">RIO DE JANEIRO</option>
                    <option value="RN">RIO GRANDE DO NORTE</option>
                    <option value="RS">RIO GRANDE DO SUL</option>
                    <option value="RO">RONDÔNIA</option>
                    <option value="RR">RORAIMA</option>
                    <option value="SC">SANTA CATARINA</option>
                    <option value="SP">SÃO PAULO</option>
                    <option value="SE">SERGIPE</option>
                    <option value="TO">TOCANTINS</option>
                </select>
            </div>

            <div class="form-group">
                <label for="raceandcolor">Raça/Cor:</label>
                <select id="raceandcolor" name="raceandcolor" required>
                    <option value="" disabled selected>Selecione sua raça/cor</option>
                    <option value="BRANCA">BRANCA</option>
                    <option value="NEGRA">NEGRA</option>
                    <option value="PARDA">PARDA</option>
                    <option value="AMARELA">AMARELA</option>
                    <option value="INDÍGENA">INDÍGENA</option>
                </select>
            </div>

            <!--<div class="form-group">
                <label for="bloodtype">Tipo Sanguíneo:</label>
                <select id="bloodtype" name="bloodtype" required>
                    <option value="" disabled selected>Selecione seu tipo sanguíneo</option>
                    <option value="NÃO SEI">NÃO SEI</option>
                    <option value="A+">A+</option>
                    <option value="A-">A-</option>
                    <option value="B+">B+</option>
                    <option value="B-">B-</option>
                    <option value="AB+">AB+</option>
                    <option value="AB-">AB-</option>
                    <option value="O+">O+</option>
                    <option value="O-">O-</option>
                </select>
            </div>

        -->
            <div class="form-group">
                <label for="email">E-mail:</label>
                <input type="email" id="email" name="email" placeholder="Digite seu e-mail..." required />
            </div>


            <div class="form-group">
                <label for="tel">Telefone (DDD + Número Sem Hífen):</label>
                <input type="text" id="tel" name="tel" placeholder="DDNNNNNNN" required
                    oninput="this.value = this.value.replace(/[^\d]/g, '').slice(0,11)" />
            </div>



            <div class="form-group">
                <label for="zip">CEP (Sem Ponto ou Hífen):</label>
                <input type="text" id="zip" name="zip" placeholder="Digite seu CEP..." required
                    oninput="this.value = this.value.replace(/[^\d]/g, '').slice(0, 8)"
                    onblur="getAddress(this.value) " />
            </div>

            <div class="form-group">
                <label for="address">Endereço:</label>
                <input type="text" id="address" name="address" placeholder="Preenchimento automático..." required
                    pattern="[A-Za-zÀ-ÿ\s]+" title="Apenas letras e espaços são permitidos" />
            </div>
            <div class="form-group">
                <label for="housenumber">Número:</label>
                <input type="text" id="housenumber" name="housenumber" placeholder="Digite o número da casa..." required
                    oninput="this.value = this.value.replace(/[^\d]/g, '').slice(0, 5)" />
            </div>

            <div class="form-group">
                <label for="housecomplement">Complemento:</label>
                <select id="housecomplement" name="housecomplement">
                    <option value="" disabled selected>Selecione seu complemento</option>
                    <option value="APTO">APARTAMENTO</option>
                    <option value="CASA">CASA</option>
                    <option value="BLOCO">BLOCO</option>
                    <option value="ANDAR">ANDAR</option>
                    <option value="SALA">SALA</option>
                    <option value="OUTRO">OUTRO</option>
                </select>
            </div>

            <div class="form-group">
                <label for="neighborhood">Bairro:</label>
                <input type="text" id="neighborhood" name="neighborhood" placeholder="Preenchimento automático..."
                    required pattern="[A-Za-zÀ-ÿ\s]+" title="Apenas letras e espaços são permitidos" />
            </div>


            <div class="form-group">
                <label for="city">Cidade:</label>
                <input type="text" id="city" name="city" placeholder="Preenchimento automático..." required
                    pattern="[A-Za-zÀ-ÿ\s]+" title="Apenas letras e espaços são permitidos" />
            </div>

            <div class="form-group">
                <label for="deficiency">Pessoa com Deficiência:</label>
                <select name="deficiency" id="deficiency">
                    <option value="SIM">SIM</option>
                    <option value="NÃO" selected>NÃO</option>
                </select>
            </div>

            <div class="form-group">
                <label for="deficiencyContext">Se SIM, especifique a deficiência. Se Não, digite: NÃO TENHO:</label>
                <input type="text" id="deficiencyContext" name="deficiencyContext" required pattern="[A-Za-zÀ-ÿ\s]+"
                    title="Apenas letras e espaços são permitidos" />
            </div>

            <div class="form-group">
                <label for="file">Arquivo único <strong>(PDF, Tamanho Máximo 10MB):</strong></label>
                <input type="file" id="file" name="file" accept=".pdf" class="file-input" onchange="checkFileSize()" />
                <small id="fileSizeError" style="color: red; display: none;">O arquivo deve ter no máximo 10MB.</small>
            </div>

            <div class="form-term">
                <input type="checkbox" id="term" name="term" required />
                <label for="term">Aceite o <a href="/terms" target="_blank">termo de privacidade</a></label>
            </div>

            <div class="form-group">
                <label for="captcha">Responda a pergunta:</label>
                <div id="captchaQuestion"></div>
                <input type="text" id="captchaAnswer" name="captchaAnswer" placeholder="Digite o resultado" required />
                <span id="captchaError" style="color: red; display: none;">Resposta incorreta!</span>
            </div>
            <div class="form-actions">
                <input class="btn" type="submit" value="Enviar" />
            </div>
        </form>
    </div>
 <canvas id="bg-canvas"></canvas>


    <div style="text-align: right;">
        <img src="/images/seguro.png" width="150px" alt="">
    </div>
 <script>
// Validação básica do CPF (formato e dígitos válidos)
function validarCPF(input) {
    const cpf = input.value.replace(/\D/g, '');
    let valido = true;

    if (cpf.length !== 11) {
        valido = false;
    } else {
        // Elimina CPFs conhecidos inválidos
        const invalidos = [
          "00000000000", "11111111111", "22222222222", "33333333333",
          "44444444444", "55555555555", "66666666666", "77777777777",
          "88888888888", "99999999999"
        ];
        if (invalidos.includes(cpf)) valido = false;

        // Validação dos dígitos verificadores
        let soma = 0;
        for (let i = 0; i < 9; i++) soma += parseInt(cpf.charAt(i)) * (10 - i);
        let resto = (soma * 10) % 11;
        if (resto === 10 || resto === 11) resto = 0;
        if (resto !== parseInt(cpf.charAt(9))) valido = false;

        soma = 0;
        for (let i = 0; i < 10; i++) soma += parseInt(cpf.charAt(i)) * (11 - i);
        resto = (soma * 10) % 11;
        if (resto === 10 || resto === 11) resto = 0;
        if (resto !== parseInt(cpf.charAt(10))) valido = false;
    }

    const spanErro = document.getElementById('cpfErro');
    if (!valido) {
        spanErro.style.display = 'inline';
        input.setCustomValidity("CPF inválido!");
    } else {
        spanErro.style.display = 'none';
        input.setCustomValidity("");
    }
}

// Validação tamanho do arquivo PDF
function checkFileSize() {
    const fileInput = document.getElementById('file');
    const errorMsg = document.getElementById('fileSizeError');
    if (fileInput.files.length > 0) {
        const file = fileInput.files[0];
        const maxSize = 10 * 1024 * 1024; // 10MB em bytes
        if (file.size > maxSize) {
            errorMsg.style.display = 'inline';
            fileInput.setCustomValidity("Arquivo muito grande");
        } else {
            errorMsg.style.display = 'none';
            fileInput.setCustomValidity("");
        }
    } else {
        errorMsg.style.display = 'none';
        fileInput.setCustomValidity("");
    }
}

// Busca endereço via API de CEP (viacep)
function getAddress(cep) {
    cep = cep.replace(/\D/g, '');
    if (cep.length !== 8) return;

    fetch(`https://viacep.com.br/ws/${cep}/json/`)
        .then(response => response.json())
        .then(data => {
            if (!data.erro) {
                document.getElementById('address').value = data.logradouro || '';
                document.getElementById('neighborhood').value = data.bairro || '';
                document.getElementById('city').value = data.localidade || '';
                document.getElementById('uf').value = data.uf || '';
            } else {
                alert("CEP não encontrado.");
            }
        })
        .catch(() => alert("Erro ao buscar endereço."));
}

// CAPTCHA simples (soma de dois números)
let captchaResult = 0;
function gerarCaptcha() {
    const num1 = Math.floor(Math.random() * 10) + 1;
    const num2 = Math.floor(Math.random() * 10) + 1;
    captchaResult = num1 + num2;
    document.getElementById('captchaQuestion').textContent = `Quanto é ${num1} + ${num2}?`;
}

function validarCaptcha() {
    const resposta = document.getElementById('captchaAnswer').value;
    const captchaError = document.getElementById('captchaError');
    if (parseInt(resposta) !== captchaResult) {
        captchaError.style.display = 'inline';
        return false;
    } else {
        captchaError.style.display = 'none';
        return true;
    }
}

// Validação geral do formulário
function validarFormulario() {
    checkFileSize();
    if (!validarCaptcha()) {
        return false;
    }
    // Se quiser pode incluir mais validações aqui
    return true;
}

// Inicializa o CAPTCHA quando a página carregar
window.onload = function() {
    gerarCaptcha();
}
  const canvas = document.getElementById('bg-canvas');
  const ctx = canvas.getContext('2d');

  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const particlesArray = [];

  for (let i = 0; i < 100; i++) {
    particlesArray.push({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height,
      size: Math.random() * 2 + 1,
      speedX: Math.random() * 0.5 - 0.25,
      speedY: Math.random() * 0.5 - 0.25,
    });
  }

  function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    particlesArray.forEach(p => {
      p.x += p.speedX;
      p.y += p.speedY;

      if (p.x < 0 || p.x > canvas.width) p.speedX *= -1;
      if (p.y < 0 || p.y > canvas.height) p.speedY *= -1;

      ctx.beginPath();
      ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
      ctx.fillStyle = 'rgba(255,255,255,0.3)';
      ctx.fill();
    });

    requestAnimationFrame(animate);
  }

  animate();
  window.addEventListener('resize', () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  });


</script>



    <%- include('../partials/footer.ejs') %>